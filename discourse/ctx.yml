## vars ###

{% set var_main_dir = 'discourse' %}
{% set var_containers = params.main.containers | default({}) %}
{% set var_pod_type = params.main.type | default('') %}

{% if not (var_pod_type in ['app', 'web', 'db']) %}
  {% set error = {} %}
  {{ error['error.pod_type.invalid.' + var_pod_type] }}
{% endif %}

{% set var_templates_files = [
  'web.template.build.yml',
  'web.template.run.yml',
  'web.template.validate.yml',
  'web.template.yml'
] %}

### main ###

files:

{% for item in var_templates_files %}

- src: "{{ var_main_dir }}/files/templates/{{ item }}"
  dest: "{{ var_main_dir }}/repo/templates/{{ item }}"
  root: true

{% endfor %}

templates:

{% for item in var_containers %}

- src: "{{ var_main_dir }}/templates/containers/{{ item.name_src }}"
  dest: "{{ var_main_dir }}/repo/containers/{{ item.name_dest }}"
  root: true
  params: "{{ item.params }}"

{% endfor %}
